Αυτός ο κώδικας ορίζει μια προσαρμοσμένη επέκταση για την πλατφόρμα NVIDIA Omniverse, η οποία δημιουργεί και διαχειρίζεται ένα 3D αντικείμενο. Η επέκταση παρακολουθεί τη θέση της σφαίρας, 
καταγράφει τα δεδομένα θέσης και τα αποθηκεύει σε ένα αρχείο JSON, προσφέροντας παράλληλα μια διεπαφή χρήστη για την προσθήκη, διαγραφή και προβολή της κίνησης της σφαίρας. Ακολουθεί μια αναλυτική εξήγηση του κώδικα:

1. Εισαγωγές:
omni.ext: Παρέχει τη βασική κλάση για τη δημιουργία επεκτάσεων στο Omniverse.
omni.ui as ui: Παρέχει τα στοιχεία διεπαφής χρήστη (UI) για τη δημιουργία της γραφικής διεπαφής της επέκτασης.
logging: Χρησιμοποιείται για την καταγραφή μηνυμάτων καταγραφής σε διάφορα στάδια του κώδικα.
time: Χρησιμοποιείται για την εισαγωγή καθυστερήσεων (στο polling).
pxr.UsdGeom και pxr.Gf: Παρέχουν το πλαίσιο USD (Universal Scene Description) για την επεξεργασία 3D δεδομένων.
threading: Επιτρέπει την εκτέλεση του polling σε ξεχωριστό νήμα.
os: Παρέχει συναρτήσεις για την επεξεργασία αρχείων.
omni.kit.commands: Παρέχει συναρτήσεις εκτέλεσης εντολών στο Omniverse.
json: Χρησιμοποιείται για την ανάγνωση και εγγραφή αρχείων JSON.
math: Παρέχει μαθηματικές συναρτήσεις, όπως μετατροπές συντεταγμένων.


3. Ορισμός Κλάσης (SphereTransformListenerExtension):
Αυτή η κλάση υλοποιεί το interface omni.ext.IExt, το οποίο είναι η βάση για τη δημιουργία επεκτάσεων στο Omniverse.

on_startup(self, ext_id):
Αυτή η μέθοδος εκτελείται όταν ξεκινά η επέκταση.

Αρχικοποιεί βασικές μεταβλητές όπως τον διακόπτη, την διαδρομή της σφαίρας, το στάδιο και τις σημαίες polling.
Δημιουργεί παράθυρο UI με κουμπιά και διακόπτη.
Προσφέρει λειτουργικότητα για δύο κουμπιά:
Add avatar: Δημιουργεί μια σφαίρα σε μια καθορισμένη θέση (/World/Sphere).
Delete avatar: Διαγράφει τη σφαίρα αν υπάρχει.
Ο διακόπτης ελέγχει την ακρίβεια που αποθηκεύεται μαζί με τη θέση της σφαίρας.
Η ετικέτα εμφάνισης δεδομένων θα εμφανίζει τις τελευταίες 7 καταχωρημένες κινήσεις της σφαίρας.

add_sphere():
Δημιουργεί μια σφαίρα σε μια καθορισμένη θέση (start_position), την προσθέτει στο στάδιο και ξεκινά την παρακολούθηση της θέσης της με polling. 
Χρησιμοποιεί την εντολή omni.kit.commands.execute() για να δημιουργήσει τη σφαίρα και να ορίσει την αρχική της θέση.

delete_sphere():
Διαγράφει τη σφαίρα εκτελώντας την εντολή 'DeletePrims'. Σταματάει το polling και αφαιρεί τα αποθηκευμένα δεδομένα αν η σφαίρα υπάρχει.

ui.Button(...):
Αυτά τα κουμπιά ενεργοποιούν τις μεθόδους add_sphere() και delete_sphere() όταν πατηθούν.

self._slider:
Ένας ακέραιος διακόπτης που ελέγχει την ακρίβεια του συστήματος καταγραφής. Κυμαίνεται από 0 έως 10.

self._data_display:
Μια ετικέτα όπου εμφανίζονται οι τελευταίες 7 καταγεγραμμένες κινήσεις της σφαίρας.

3. Παρακολούθηση της Μετατόπισης της Σφαίρας:
Η επέκταση παρακολουθεί την κίνηση της σφαίρας μέσω ενός συστήματος polling που εκτελείται σε ξεχωριστό νήμα.

_start_transform_polling(self):
Ξεκινάει ένα ξεχωριστό νήμα που ελέγχει περιοδικά τη θέση της σφαίρας κάθε δευτερόλεπτο.

_stop_transform_polling(self):
Σταματάει το νήμα polling με ασφάλεια.

_poll_transform(self):
Το νήμα polling κοιμάται για 1 δευτερόλεπτο και στη συνέχεια ελέγχει για αλλαγές στη θέση της σφαίρας καλώντας την μέθοδο self._check_sphere_transform().

4. Έλεγχος της Μετατόπισης:
_check_sphere_transform(self):
Ανακτά τη σφαίρα χρησιμοποιώντας την self._sphere_path.
Υπολογίζει τη θέση της σφαίρας από τον τοπικό προς τον παγκόσμιο μετασχηματισμό και τη συγκρίνει με την τελευταία καταγεγραμμένη θέση (self._last_position).
Αν έχει αλλάξει η θέση, την καταγράφει και στέλνει τα δεδομένα στο backend καλώντας τη μέθοδο self._send_data_to_backend(position).

5. Αποστολή Δεδομένων στο Backend:
_send_data_to_backend(self, position):
Μετατρέπει τις καρτεσιανές συντεταγμένες της σφαίρας σε γεωγραφικό πλάτος και μήκος χρησιμοποιώντας τη σφαιρική γεωμετρία.
Ανακτά την τρέχουσα τιμή του διακόπτη για την "ακρίβεια."
Προσθέτει τα δεδομένα (μήκος, πλάτος, ακρίβεια) σε ένα αρχείο JSON.
Η ενέργεια καταγράφεται ως "created" όταν δημιουργείται η σφαίρα ή "moved" όταν αλλάζει θέση.

Μορφή Δεδομένων στο JSON:
Το αρχείο JSON αποθηκεύει τα εξής δεδομένα για κάθε κίνηση της σφαίρας:
```
{
  "action": "created/moved",
  "longitude": <value>,
  "latitude": <value>,
  "accuracy": <value>
}
```
6. Λήψη Δεδομένων από το Backend:
_receive_data_from_backend(self):
Διαβάζει το αρχείο JSON που περιέχει τα καταγεγραμμένα δεδομένα.
Εξάγει τις τελευταίες 7 εγγραφές και τις μορφοποιεί σε μηνύματα που εμφανίζονται στην ετικέτα self._data_display.
Διαχειρίζεται περιπτώσεις όπου το αρχείο είναι άδειο ή μη αναγνώσιμο.

7. Διαχείριση Αρχείων:
_remove_file_if_exists(self):
Αν το αρχείο JSON υπάρχει, προσπαθεί να το διαγράψει και καταγράφει τυχόν σφάλματα αν η διαγραφή αποτύχει λόγω αδειών ή άλλων προβλημάτων.

8. Τερματισμός:
on_shutdown(self):
Διασφαλίζει ότι το νήμα polling σταματά και καθαρίζεται όταν τερματίζεται η επέκταση.
